#!/bin/bash
set -euo pipefail

DOTFILES_DIR=${DOTFILES_DIR:-~/dotfiles}
echo "Integrating n8n MCP..."

if [ -d "$HOME/.n8n-mcp" ]; then
  config_json="{\"command\":\"node\",\"args\":[\"$HOME/.n8n-mcp/build/index.js\"]}"
  echo "Adding n8n MCP to Claude Code..."
  claude mcp add-json n8n "$config_json" --scope user
  echo "âœ“ n8n MCP integrated"
  "$DOTFILES_DIR/bin/codex-mcp" upsert n8n <<EOF
[mcp.servers.n8n]
# Goose integration
"$DOTFILES_DIR/goose/integrate" upsert-stdio n8n node "$HOME/.n8n-mcp/build/index.js"
