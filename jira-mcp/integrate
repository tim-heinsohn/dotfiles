#!/bin/bash
set -euo pipefail

DOTFILES_DIR=${DOTFILES_DIR:-~/dotfiles}
echo "Integrating Jira MCP..."

if [ -f "$HOME/.jira-mcp/bin/mcp-server" ]; then
  config_json="{\"command\":\"$HOME/.jira-mcp/bin/mcp-server\",\"env\":{}}"
  echo "Adding Jira MCP to Claude Code..."
  claude mcp add-json jira "$config_json" --scope user
  echo "âœ“ Jira MCP integrated"
  echo "Note: Set JIRA_API_TOKEN, JIRA_EMAIL, and JIRA_URL environment variables"
  "$DOTFILES_DIR/bin/codex-mcp" upsert jira <<EOF
[mcp.servers.jira]
# Goose integration
"$DOTFILES_DIR/goose/integrate" upsert-stdio jira "$HOME/.jira-mcp/bin/mcp-server"
