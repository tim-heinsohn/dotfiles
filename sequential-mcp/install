#!/bin/bash

# Sequential MCP Server Installation Script
# Based on modelcontextprotocol/sequential-thinking-mcp-server

set -euo pipefail

SEQUENTIAL_MCP_DIR="$HOME/.sequential-mcp"
SEQUENTIAL_MCP_REPO="https://github.com/modelcontextprotocol/sequential-thinking-mcp-server.git"

echo "Installing Sequential MCP Server..."

# Create directory if it doesn't exist
mkdir -p "$SEQUENTIAL_MCP_DIR"

# Clone or update the repository
if [ -d "$SEQUENTIAL_MCP_DIR/.git" ]; then
    echo "Updating existing Sequential MCP Server..."
    cd "$SEQUENTIAL_MCP_DIR"
    git pull
else
    echo "Cloning Sequential MCP Server..."
    git clone "$SEQUENTIAL_MCP_REPO" "$SEQUENTIAL_MCP_DIR"
    cd "$SEQUENTIAL_MCP_DIR"
fi

# Install dependencies
echo "Installing dependencies..."
npm install

# Build the server
echo "Building sequential MCP server..."
npm run build

echo "Sequential MCP Server installed successfully!"
echo ""
echo "Next steps:"
echo "1. Add Sequential MCP to Claude Code configuration"
echo "2. The server is ready to use - no additional authentication required"
echo ""
echo "See: ~/dotfiles/sequential-mcp/doc/usage.md for detailed usage instructions"