#!/bin/bash
set -euo pipefail

DOTFILES_DIR=${DOTFILES_DIR:-~/dotfiles}
echo "Integrating Sequential MCP..."

if [ -d "$HOME/.sequential-mcp" ] && [ -f "$HOME/.sequential-mcp/dist/index.js" ]; then
  config_json="{\"command\":\"node\",\"args\":[\"$HOME/.sequential-mcp/dist/index.js\"]}"
  echo "Adding Sequential MCP to Claude Code..."
  claude mcp add-json sequential "$config_json" --scope user
  echo "âœ“ Sequential MCP integrated with Claude Code"

  "$DOTFILES_DIR/bin/codex-mcp" upsert sequential <<EOF
[mcp.servers.sequential]
command = "node"
args = ["$HOME/.sequential-mcp/dist/index.js"]
EOF
else
  echo "Error: Sequential MCP not installed. Run: mcp install sequential" >&2
  exit 1
fi

