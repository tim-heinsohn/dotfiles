#!/bin/bash
set -euo pipefail

DOTFILES_DIR=${DOTFILES_DIR:-~/dotfiles}
echo "Integrating YouTube Playlist MCP..."

if [ -d "$HOME/.youtube-playlist-mcp" ] && [ -f "$HOME/.youtube-playlist-mcp/dist/index.js" ]; then
  config_json="{\"command\":\"node\",\"args\":[\"$HOME/.youtube-playlist-mcp/dist/index.js\"],\"env\":{\"GOOGLE_APPLICATION_CREDENTIALS\":\"$HOME/.youtube-playlist-mcp/credentials.json\"}}"
  echo "Adding YouTube Playlist MCP to Claude Code..."
  claude mcp add-json youtube-playlist "$config_json" --scope user
  echo "âœ“ YouTube Playlist MCP integrated"
  echo "Note: Ensure OAuth credentials are set up (see ~/.youtube-playlist-mcp/oauth-setup.md)"
  "$DOTFILES_DIR/bin/codex-mcp" upsert youtube-playlist <<EOF
[mcp.servers.youtube-playlist]
# Goose integration
"$DOTFILES_DIR/goose/integrate" upsert-stdio youtube-playlist node "$HOME/.youtube-playlist-mcp/dist/index.js"
